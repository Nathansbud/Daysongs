const datedTracks = {
  "01-01": [
    {
      "title": "The New Year",
      "artist": "Death Cab for Cutie",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3yLgtIF1dEk9LJzaARBRxJ?si=pD6rdB20Tnm-Ayp3Hsd_UQh"
      },
    }
  ],
  "01-10": [
    {
      "title": "January 10, 2014",
      "artist": "The World Is A Beautiful Place & I Am No Longer Afraid To Die",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/0CZpruCAAoKC9DXB587jeN?si=2e1245dca3714bcdh"
      },
    }
  ],
  "01-11": [
    {
      "title": "January 11",
      "artist": "Robo Pumpkin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/6a8bmL8HEhf8k3D1krmajS?si=d22e7e93c1ee4425h"
      },
    }
  ],
  "01-28": [
    {
      "title": "January 28",
      "artist": "J Cole",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/6LBpGdlukUARutol7VgWIS?si=2282bc8f1e4b49cah"
      },
    }
  ],
  "02-03": [
    {
      "title": "February 3",
      "artist": "Jorja Smith",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3c5gLGgwRrE7sQYSNHCXEj?si=4de39b2be0004789h"
      },
    }
  ],
  "02-26": [
    {
      "title": "February 26",
      "artist": "Robo Pumpkin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4LgpU7rGq7JKBH6w27wpKU?si=2f3c2c8ed22b4b74h"
      },
    },
    {
      "title": "February 26",
      "artist": "Bailey Grey",
      "external_links": {
        "apple": "https://music.apple.com/us/song/february-26/1682228866",
        "spotify": "https://open.spotify.com/track/3T2FWYUF9763pYMZJ600ip?si=218dd4bc8b0044bd",
        "tidal": "https://tidal.com/track/289014739/"
      }
    }
  ],
  "03-01": [
    {
      "title": "Casimir Pulaski Day",
      "artist": "Sufjan Stevens",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/53TIOhzNpRpl8xKdscSQSv?si=2027e2eb4f4949bdh"
      },
    }
  ],
  "03-14": [
    {
      "title": "March 14",
      "artist": "Drake",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/09lmraDvzBT3pUQ2rUtJzK?si=c114c31fe2964a19h"
      },
    }
  ],
  "03-19": [
    {
      "title": "(March 19 1983) It Was Probably Green",
      "artist": "Carissa's Wierd",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/6e7oObDahu70V9bd1zsqON?si=46c8672f1ff4481fh"
      },
    }
  ],
  "04-01": [
    {
      "title": "Avery Island / April 1",
      "artist": "Neutral Milk Hotel",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/04aJtorJL9ad4JbExB9IEy?si=6c42c100d4b843ebh"
      },
    }
  ],
  "04-04": [
    {
      "title": "Pride (In The Name Of Love)",
      "artist": "U2",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3dh2LlmeMqKJbzn2WUgt3d?si=ba0eff13d7494e5bh"
      },
    }
  ],
  "04-14": [
    {
      "title": "Avril 14",
      "artist": "Aphex Twin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/1uaGSDFsLdReQgg8p7Obwh?si=4dU3fxMMT9e33Cd9xBG7iAh"
      },
    },
    {
      "title": "April the 14th Part 1",
      "artist": "Gillian Welch",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5EanV7AK9n1q76Ecxe31YH?si=40398d1870714c36h"
      },
    },
    {
      "title": "D\u00eda 14 de Abril",
      "artist": "Rosal\u00eda",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/623kdaD0Wi2L0L6GyZvXUP?si=e817eba1952b4353h"
      },
    }
  ],
  "04-21": [
    {
      "title": "21/04/20",
      "artist": "Kero Kero Bonito",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3a6Bj474rn6AGwRGgNBFMp?si=0f6a15f40854447fh"
      },
    }
  ],
  "04-25": [
    {
      "title": "April 25",
      "artist": "The Goalie\u2019s Anxiety at the Penalty Kick",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/6loq6S1izAysB74laFPod7?si=MiviSVXNSriNX2v71BCeAAh"
      },
    }
  ],
  "04-26": [
    {
      "title": "Churro",
      "artist": "Malibu Ken",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/58DV1sAKBJobANTUCklFryh"
      },
    }
  ],
  "04-29": [
    {
      "title": "High Infidelity",
      "artist": "Taylor Swift",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/17fWdcSAhLc6559youmLap?si=c096391430354382h"
      },
    }
  ],
  "05-03": [
    {
      "title": "Third of May",
      "artist": "Fleet Foxes",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2tUiuvEUs1Tw2pnfZUeIz1?si=f74668c5ecf14e40h"
      },
    }
  ],
  "05-05": [
    {
      "title": "Isis",
      "artist": "Bob Dylan",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5j216bw8PG0EcIdfu92k4l?si=6122d3344dd84b9fh"
      },
    }
  ],
  "05-09": [
    {
      "title": "May Ninth",
      "artist": "Khruangbin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5yVGW2o9LXaiiS4I3HUM3k?si=26dbf86df5de4a3ch"
      },
    }
  ],
  "05-10": [
    {
      "title": "The Night They Drove Old Dixie Down",
      "artist": "The Band",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5yVGW2o9LXaiiS4I3HUM3k?si=26dbf86df5de4a3ch"
      },
    },
    {
      "title": "Jackie Onassis",
      "artist": "Sammy Rae & The Friends",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5yVGW2o9LXaiiS4I3HUM3k?si=26dbf86df5de4a3ch"
      },
    }
  ],
  "05-13": [
    {
      "title": "Red-Winged Black Birds (March 13, 2024)",
      "artist": "Simon Joyner",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5yVGW2o9LXaiiS4I3HUM3k?si=26dbf86df5de4a3ch"
      },
    }
  ],
  "05-19": [
    {
      "title": "Burning",
      "artist": "Sam Smith",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2nvcTDmZkRWKNMAL29sLHo?si=404e7ecba51a4caeh"
      },
    }
  ],
  "05-21": [
    {
      "title": "21st of May",
      "artist": "Nickel Creek",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2nvcTDmZkRWKNMAL29sLHo?si=404e7ecba51a4caeh"
      },
    }
  ],
  "05-27": [
    {
      "title": "Marvin Hits Trina",
      "artist": "Falsettos Cast Recording",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/7GPBA8xjMJyN6SjoKd4O9E?si=11d483c5b6484df1h"
      },
    }
  ],
  "06-14": [
    {
      "title": "june 14",
      "artist": "Lauren Auder",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2mb6YdoavL6db22p7XKJQZ?si=58247272f62a4beah"
      },
    }
  ],
  "06-19": [
    {
      "title": "party 4 u",
      "artist": "Charli XCX",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/0hyhmEE6fFefO00bGN1yxD?si=c6a575768e994044h"
      },
    }
  ],
  "06-21": [
    {
      "title": "June 21st",
      "artist": "Jeff Rosenstock",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/1Z0cKK7G8qoXcccl6n7t9Y?si=a0dcf0ea497541e6h"
      },
    },
    {
      "title": "June 21",
      "artist": "Prototymartyr",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2fgAJeky8Cpsr8Cfvn2NVp?si=13924c6159f54f38h"
      },
    }
  ],
  "06-25": [
    {
      "title": "June 25",
      "artist": "Robo Pumpkin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2RdEC8Ff83WkX7kDVCHseE?si=9512ad8d04104737h"
      },
    }
  ],
  "07-01": [
    {
      "title": "Cross Your Mind",
      "artist": "Shelly",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3DqEUd9EoYPcNCa26U6226?si=9d7077b901d1486ch"
      },
    }
  ],
  "07-04": [
    {
      "title": "Fourth of July",
      "artist": "Sufjan Stevens",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3DqEUd9EoYPcNCa26U6226?si=9d7077b901d1486ch"
      },
    },
    {
      "title": "The Remedy (I Won't Worry)",
      "artist": "Jason Mraz",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3DqEUd9EoYPcNCa26U6226?si=9d7077b901d1486ch"
      },
    },
    {
      "title": "Star Witness",
      "artist": "Neko Case",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3DqEUd9EoYPcNCa26U6226?si=9d7077b901d1486ch"
      },
    },
    {
      "title": "4th of July, Ashbury Park (Sandy)",
      "artist": "Bruce Springsteen",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    },
    {
      "title": "Saturday in the Park",
      "artist": "Chicago",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    },
    {
      "title": "5th of July",
      "artist": "Owl City",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    },
    {
      "title": "Knew Better (with Lil Yachty)",
      "artist": "JID",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    },
    {
      "title": "Fourth of July",
      "artist": "Sluice",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    }
  ],
  "07-05": [
    {
      "title": "Cassius, -",
      "artist": "Fleet Foxes",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    },
    {
      "title": "5th of July",
      "artist": "Owl City",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    }
  ],
  "08-10": [
    {
      "title": "August 10",
      "artist": "Julie Doiron",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3I0FBDc1c1BLNtXWKVjmFg?si=0ff4630b4fef4abbh"
      },
    }
  ],
  "08-26": [
    {
      "title": "August 26 â€“ 27",
      "artist": "Robo Pumpkin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4M2t7bP4Mq87mGMn0PObUX?si=d9c8e30b476b4846h"
      },
    }
  ],
  "08-27": [
    {
      "title": "August 26\u201327",
      "artist": "Robo Pumpkin",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3a3zDlE4bgI6ZvU00m6o84?si=-HCkETQwRVezRQjz0NvZ0gh"
      },
    }
  ],
  "09-03": [
    {
      "title": "Papa Was a Rollin' Stone",
      "artist": "The Temptations",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3a3zDlE4bgI6ZvU00m6o84?si=-HCkETQwRVezRQjz0NvZ0gh"
      },
    }
  ],
  "09-04": [
    {
      "title": "September 4",
      "artist": "Bruno Pernadas",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3a3zDlE4bgI6ZvU00m6o84?si=-HCkETQwRVezRQjz0NvZ0gh"
      },
    }
  ],
  "09-06": [
    {
      "title": "untitled 08 | 09.06.2014.",
      "artist": "Kendrick Lamar",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3a3zDlE4bgI6ZvU00m6o84?si=-HCkETQwRVezRQjz0NvZ0gh"
      },
    }
  ],
  "09-11": [
    {
      "title": "everyday feels like 9/11",
      "artist": "Home is Where",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/5Qnrgqy1pAm9GyNQOgyVFzh"
      },
    }
  ],
  "09-12": [
    {
      "title": "9/12",
      "artist": "Home is Where",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/17fWdcSAhLc6559youmLap?si=ac10e8b8d7cb43d2h"
      },
    }
  ],
  "09-21": [
    {
      "title": "Earth, Wind, & Fire",
      "artist": "September",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/53TIOhzNpRpl8xKdscSQSv?si=1La9nmyXStaqyP6afYPoNwh"
      },
    },
    {
      "title": "untitled 05 | 09.21.2014.",
      "artist": "Kendrick Lamar",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "09-26": [
    {
      "title": "September 16",
      "artist": "Kid Cudi",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2DT8KK9JK8HqPph9ZuWVn3?si=ad6448194c5d4912h"
      },
    }
  ],
  "09-29": [
    {
      "title": "29 de Septiembre",
      "artist": "Las Ligas Menores",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "10-13": [
    {
      "title": "emails i can't send",
      "artist": "Sabrina Carpenter",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "10-31": [
    {
      "title": "The New Style",
      "artist": "Beastie Boys",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "11-05": [
    {
      "title": "Remember",
      "artist": "John Lennon",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "11-10": [
    {
      "title": "A 1000 Times",
      "artist": "Hamilton Leithauser & Rostam",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "11-18": [
    {
      "title": "November 18",
      "artist": "Drake",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "12-01": [
    {
      "title": "Sweet Baby James",
      "artist": "James Taylor",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "12-04": [
    {
      "title": "December 4",
      "artist": "Jay-Z",
      "external_links": {
        "apple": "https://music.apple.com/us/song/december-4th/1440785596",
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh",
        "tidal": "https://tidal.com/track/35589581"
      },
    },
    {
      "title": "We",
      "artist": "The Roches",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/4OJFkrRQqol4FsPesF8eu4?si=f4129bf358464aabh"
      },
    }
  ],
  "12-18": [
    {
      "title": "Margaret",
      "artist": "Lana Del Ray",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/7n2To0qEgpU2dsZh9srwJI?si=2e3ea8cff2bf4d27h"
      },
    }
  ],
  "12-24": [
    {
      "title": "December 24",
      "artist": "Earl Sweatshirt",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/7n2To0qEgpU2dsZh9srwJI?si=2e3ea8cff2bf4d27h"
      },
    },
    {
      "title": "Chateau Lobby #4",
      "artist": "Father John Misty",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3mEvpOYZJMtKgF2dWklmq5?si=d9c57e18e0804289h"
      },
    }
  ],
  "12-25": [
    {
      "title": "December",
      "artist": "Earth, Wind & Fire",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/2DT8KK9JK8HqPph9ZuWVn3?si=ad6448194c5d4912h"
      },
    },
    {
      "title": "25th December",
      "artist": "Everything But The Girl",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/3zSM2Yqh0gnGeWSRWqUTxs?si=88ac6c5dc7ed4f8fh"
      },
    },
    {
      "title": "It's Christmas And I Fucking Miss You",
      "artist": "Charly Bliss & PUP",
      "external_links": {
        "apple": null,
        "spotify": "https://open.spotify.com/track/0yOf4dgkVq8jbB2zxVK8Zj?si=4181016b70d04da6h"
      },
    }
  ]
}

const holidayTracks = {
  "easter": []
}

function div(a, b) {return Math.floor(a/b)}
function isEaster(date) {
  const year = date.getFullYear()
  const a = year % 19
  const b = div(year, 100)
  const c = year % 100
  const d = div(b, 4)
  const e = b % 4
  const f = div(b + 8, 25)
  const g = div(b - f + 1, 3)
  const h = (19*a + b - d - g + 15) % 30
  const i = div(c, 4)
  const k = c % 4
  const l = (32 + 2 * e + 2 * i - h - k) % 7
  const m = div(a + 11*h + 22 * l, 451)
  const month = div(h + l - 7*m + 114, 31)
  const day = ((h+l-7*m+114)%31)+1
  console.log([month, day])
  return (date.getMonth() + 1 === month && date.getDate() === day)
}

let currentTrackIndex = 0
let currentTracks = []

function formatDateName(date) {
    const monthNames = [
        'January', 'February', 'March', 'April', 'May', 'June',
        'July', 'August', 'September', 'October', 'November', 'December'
    ]
    return `${monthNames[date.getMonth()]} ${date.getDate()}, ${date.getFullYear()}`
}

function displayTrack(index) {
    if (!currentTracks || currentTracks.length === 0) return

    const track = currentTracks[index]
    const songTitle = document.getElementById('song-title')
    const songArtist = document.getElementById('song-artist')
    const externalLinks = document.getElementById('external-links')
    const songCounter = document.getElementById('song-counter')

    songTitle.textContent = track.title
    songArtist.textContent = track.artist

    externalLinks.innerHTML = ''
    if (track.external_links) {
        if (track.external_links.spotify) {
            const spotifyLink = document.createElement('a')
            spotifyLink.href = track.external_links.spotify
            spotifyLink.textContent = 'Spotify'
            spotifyLink.target = '_blank'
            spotifyLink.className = 'external-link spotify'
            externalLinks.appendChild(spotifyLink)
        }
        if (track.external_links.apple) {
            const appleLink = document.createElement('a')
            appleLink.href = track.external_links.apple
            appleLink.textContent = 'Apple Music'
            appleLink.target = '_blank'
            appleLink.className = 'external-link apple'
            externalLinks.appendChild(appleLink)
        }

        if(track.external_links.tidal) {
            const tidalLink = document.createElement('a')
            tidalLink.href = track.external_links.tidal
            tidalLink.textContent = 'Tidal'
            tidalLink.target = '_blank'
            tidalLink.className = 'external-link tidal'
            externalLinks.appendChild(tidalLink)
        }
    }

    songCounter.textContent = `${index + 1} / ${currentTracks.length}`
}

function navigatePrev() {
    if (currentTrackIndex > 0) {
        currentTrackIndex--
    } else {
        currentTrackIndex = currentTracks.length - 1
    }
    displayTrack(currentTrackIndex)
}

function navigateNext() {
    if (currentTrackIndex < currentTracks.length - 1) {
        currentTrackIndex++
    } else {
        currentTrackIndex = 0
    }
    displayTrack(currentTrackIndex)
}

window.onload = () => {
    const today = new Date()

    const month = (today.getMonth() + 1).toString().padStart(2, '0')
    const day = today.getDate().toString().padStart(2, '0')
    const dictKey = `${month}-${day}`

    const dateName = document.getElementById('date-name')
    const noSongMessage = document.getElementById('no-song-message')
    const songInfo = document.getElementById('song-info')
    const navigation = document.getElementById('navigation')
    const prevBtn = document.getElementById('prev-btn')
    const nextBtn = document.getElementById('next-btn')

    dateName.textContent = formatDateName(today)
    currentTracks = (datedTracks[dictKey] || []).concat(
      isEaster(today) ? holidayTracks['easter'] : []
    )

    const count = currentTracks.length

    if (count === 0) {
        noSongMessage.style.display = 'block'
        songInfo.style.display = 'none'
    } else {
        noSongMessage.style.display = 'none'
        songInfo.style.display = 'block'

        currentTrackIndex = 0
        displayTrack(currentTrackIndex)

        if (count > 1) {
            navigation.style.display = 'flex'
            prevBtn.addEventListener('click', navigatePrev)
            nextBtn.addEventListener('click', navigateNext)
        }
    }
}